# パフォーマンス測定レポート（POST /login）

本ドキュメントは、筋トレ日記アプリにおけるログイン API
`POST /login` のパフォーマンスを **ローカル環境** と **デプロイ環境**
の両方で測定し、性能分析およびボトルネックの有無を評価する目的で作成

---

## 1. 測定対象 API

### `POST /login`

選定理由：
- プロダクト全体で必須となる API

---

## 2. 測定環境

| 項目 | ローカル環境 | デプロイ環境 |
|------|--------------|--------------|
| 稼働環境 | Docker (Mac) | GCP（デプロイ済み Go API） |
| DB | PostgreSQL（local docker） | Neon |
| 通信経路 | localhost | インターネット越し |

### データ量（現状仕様）

| データ | 件数 |
|--------|------|
| 投稿件数 | 約10件 |
| いいね件数 | 未集計（いいね済みフラグのみを返却） |

※本APIでは `like_count` を返却しないため、  
レスポンスサイズは小さく、集計コストも低い。  
本測定では SELECT + JOIN + JSON エンコード処理を主な対象とする。

---

## 3. 測定方法

### 使用コマンド

```bash
curl -w "%{time_total}\n" \
  -X POST \
  -H "Content-Type: application/json" \
  -d '{"email":"a@a.com","password":"aaaaaa"}' \
  -o /dev/null -s \
  http://localhost:8080/login

curl -w "%{time_total}\n" \
  -X POST \
  -H "Content-Type: application/json" \
  -d '{"email":"a@a.com","password":"aaaaaa"}' \
  -o /dev/null -s \
  https://muscle-diary-backend-259090965328.asia-northeast1.run.app/login

```

### 測定条件

3回計測し平均値を算出
同一端末から実行
キャッシュなし

---


## 4. 測定結果

### ローカル環境(レコード数15件)
|  実行回数                   | time_total(秒)          |   ミリ秒換算  |
| --------------- | ------------- |-------------------|
| 1回目               | 0.080835    |  約80.8ms   |
| 2回目       | 0.097458   |  約97.4ms     |
|  3回目          |  0.090345 |  約 90.3ms  |

平均値：  89.5ms

### デプロイ環境(レコード数15件)
| 実行回数 | time_total(秒) | ミリ秒換算 |
|----------|----------------|------------|
| 1回目 | 0.324143 | 約 324 ms |
| 2回目 | 0.330402 | 約 330 ms |
| 3回目 | 0.341666 | 約 341 ms |

平均値： 332 ms
---

## 5. 分析

### ローカル環境
- 80〜97ms と安定
- login は bcrypt のハッシュ比較が主要コストのため、4ms レベルの timeline より遅い
- それでも 100ms 未満であり体感上は高速

### デプロイ環境
- 324〜341ms 程度で安定
- UX 許容範囲 100〜500ms に収まっている

---

## 6. ボトルネック判断
### ローカル環境
- 80〜97msと安定しているため、ボトルネックは存在しないと判断する。

### デプロイ環境
- 324〜341ms 程度で安定であり、明確な性能劣化は観測されていないためボトルネックは存在しないと判断する。
